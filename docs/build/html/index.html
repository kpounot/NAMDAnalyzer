
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>NAMDAnalyzer’s documentation &#8212; NAMDAnalyzer 1.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dataset" href="modules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Dataset"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">NAMDAnalyzer 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="namdanalyzer-s-documentation">
<h1>NAMDAnalyzer’s documentation<a class="headerlink" href="#namdanalyzer-s-documentation" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="namdanalyzer">
<h1>NAMDAnalyzer<a class="headerlink" href="#namdanalyzer" title="Permalink to this headline">¶</a></h1>
<p>Python based routines for molecular dynamics simulation analysis from NAMD</p>
<div class="section" id="installation">
<h2>Installation:<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="unix-and-windows">
<h3>Unix and Windows<a class="headerlink" href="#unix-and-windows" title="Permalink to this headline">¶</a></h3>
<p>To install it within your python distribution, use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="p">[</span><span class="n">build</span><span class="p">]</span> <span class="p">(</span><span class="k">for</span> <span class="n">openMP</span> <span class="n">version</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[</span><span class="n">build_cuda</span><span class="p">]</span> <span class="p">(</span><span class="k">for</span> <span class="n">CUDA</span> <span class="n">accelerated</span> <span class="n">version</span> <span class="o">-</span> <span class="n">recommended</span><span class="p">)</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="n">build</span><span class="p">,</span> <span class="n">build_cuda</span><span class="p">]</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="start-the-interpreter">
<h2>Start the interpreter:<a class="headerlink" href="#start-the-interpreter" title="Permalink to this headline">¶</a></h2>
<p>Initialization of the ipython console can be done using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipython</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">NAMDAnalyzer</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span> <span class="o">--</span> <span class="o">&lt;</span><span class="nb">list</span> <span class="n">of</span> <span class="n">files</span> <span class="n">to</span> <span class="n">be</span> <span class="n">loaded</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">stride</span><span class="p">]</span>
</pre></div>
</div>
<p>Options:</p>
<ul class="simple">
<li><dl class="simple">
<dt>-s –stride</dt><dd><p>use to skip frames when loading a .dcd file. For instance if “-s 5” is provided,
only the frames that are multiples of 5 will be loaded.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="usage">
<h2>Usage:<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The program is organized on a master class contained in NAMDAnalyzer.Dataset.</p>
<div class="section" id="open-log-file-and-plot-data">
<h3>Open log file and plot data<a class="headerlink" href="#open-log-file-and-plot-data" title="Permalink to this headline">¶</a></h3>
<p>To analyze log file, the following can be used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">NAMDAnalyzer</span> <span class="kn">as</span> <span class="nn">nda</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">nda</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;20190326_fss_tip4p_prelax.out&#39;</span><span class="p">)</span> <span class="c1">#_Import log file</span>

<span class="c1">#_Another log file can be append to the imported one using data.logData.appendLOG() method</span>

<span class="c1">#_To plot data series using keywords given in data.logData.etitle, removing first 500 frames of minimization</span>
<span class="n">data</span><span class="o">.</span><span class="n">logData</span><span class="o">.</span><span class="n">plotDataSeries</span><span class="p">(</span><span class="s1">&#39;TEMP KINETIC TOTAL&#39;</span><span class="p">,</span> <span class="n">begin</span><span class="o">=</span><span class="mi">501</span><span class="p">)</span>

<span class="c1">#_To plot data distribution</span>
<span class="n">data</span><span class="o">.</span><span class="n">logData</span><span class="o">.</span><span class="n">plotDataDistribution</span><span class="p">(</span><span class="s1">&#39;KINETIC&#39;</span><span class="p">,</span> <span class="n">binSize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1">#_Data can be fitted with any model using</span>
<span class="n">data</span><span class="o">.</span><span class="n">logData</span><span class="o">.</span><span class="n">plotDataDistribution</span><span class="p">(</span><span class="s1">&#39;KINETIC&#39;</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">your_model_function</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">init_parameters</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="outputs-of-previous-code">
<h4>Outputs of previous code:<a class="headerlink" href="#outputs-of-previous-code" title="Permalink to this headline">¶</a></h4>
<a class="reference internal image-reference" href="_images/log_dataSeries.png"><img alt="_images/log_dataSeries.png" src="_images/log_dataSeries.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/log_dataDist.png"><img alt="_images/log_dataDist.png" src="_images/log_dataDist.png" style="width: 24%;" /></a>
</div>
</div>
<div class="section" id="load-trajectories-selection-and-analysis">
<h3>Load trajectories, selection, and analysis<a class="headerlink" href="#load-trajectories-selection-and-analysis" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">NAMDAnalyzer</span> <span class="kn">as</span> <span class="nn">nda</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">nda</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;psfFile.psf&#39;</span><span class="p">,</span> <span class="s1">&#39;dcdFile.dcd&#39;</span><span class="p">)</span>

<span class="c1">#_Trajectories can be append to already loaded ones using either d.appendDCD(&#39;dcdFile.dcd&#39;)</span>
<span class="c1">#_or d.appendCoordinates(&#39;pdbFile.pdb&#39;).</span>


<span class="c1">#_To compute RMSD per atom for molecules aligned in all frames</span>
<span class="n">d</span><span class="o">.</span><span class="n">getRMSDperAtom</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="s1">&#39;protein and segname V1&#39;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>

<span class="c1">#_To compute and plot RMSD per atom for molecules aligned in all frames</span>
<span class="n">d</span><span class="o">.</span><span class="n">plotRMSDperAtom</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="s1">&#39;protein and segname V1&#39;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>



<span class="c1">#_To compute radial pair distribution function for water within 3 angstrom of a protein region</span>
<span class="n">r</span><span class="p">,</span> <span class="n">pdf</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">getRadialNumberDensity</span><span class="p">(</span> <span class="s1">&#39;name OH2 and within 3 of protein and resid 40:80&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;name OH2 and within 3 of protein and resid 40:80&#39;</span><span class="p">,</span>
                                   <span class="n">dr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">maxR</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pdf</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;radius r [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">rho (r)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>



<span class="c1">#_To plot averaged distances between a residue and the rest of the protein using a parallel plot</span>
<span class="n">d</span><span class="o">.</span><span class="n">plotAveragedDistances_parallelPlot</span><span class="p">(</span><span class="s1">&#39;protein and resid 53&#39;</span><span class="p">,</span> <span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="n">maxDist</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#_To plot the same distances but using a chord diagram</span>
<span class="n">cd</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">plotAveragedDistances_chordDiagram</span><span class="p">(</span><span class="s1">&#39;protein and resid 53&#39;</span><span class="p">,</span> <span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="n">maxDist</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cd</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="id1">
<h4>Outputs of previous code:<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<a class="reference internal image-reference" href="_images/ubq_rmsdPerAtom.png"><img alt="_images/ubq_rmsdPerAtom.png" src="_images/ubq_rmsdPerAtom.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/radialDistWater.png"><img alt="_images/radialDistWater.png" src="_images/radialDistWater.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/averagedDistances_parallel.png"><img alt="_images/averagedDistances_parallel.png" src="_images/averagedDistances_parallel.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/averagedDistances_chord.png"><img alt="_images/averagedDistances_chord.png" src="_images/averagedDistances_chord.png" style="width: 24%;" /></a>
</div>
</div>
<div class="section" id="analysis-of-rotations">
<h3>Analysis of rotations<a class="headerlink" href="#analysis-of-rotations" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">NAMDAnalyzer</span> <span class="kn">as</span> <span class="nn">nda</span>
<span class="kn">from</span> <span class="nn">NAMDAnalyzer.dataAnalysis.Rotations</span> <span class="kn">import</span> <span class="n">Rotations</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">nda</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;psfFile.psf&#39;</span><span class="p">,</span> <span class="s1">&#39;dcdFile.dcd&#39;</span><span class="p">)</span>


<span class="c1">#_To analyze O-H1 water vectors for O being within 3 angstrom of protein region</span>
<span class="n">rot</span> <span class="o">=</span> <span class="n">Rotations</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;name OH2 and within 3 of protein and resid 40:80&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;name H1 and bound to name OH2 and within 3 of protein and resid 40:80&#39;</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">nbrTimeOri</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">rot</span><span class="o">.</span><span class="n">compRotationalRelaxation</span><span class="p">()</span>
<span class="n">rot</span><span class="o">.</span><span class="n">compOrientationalProb</span><span class="p">()</span>

<span class="n">rot</span><span class="o">.</span><span class="n">plotRotationalRelaxation</span><span class="p">()</span>
<span class="n">rot</span><span class="o">.</span><span class="n">plotOrientationalProb</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="id2">
<h4>Outputs of previous code:<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<a class="reference internal image-reference" href="_images/rotRelaxation.png"><img alt="_images/rotRelaxation.png" src="_images/rotRelaxation.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/rotOrientationProb.png"><img alt="_images/rotOrientationProb.png" src="_images/rotOrientationProb.png" style="width: 24%;" /></a>
</div>
</div>
<div class="section" id="analysis-of-hydrogen-bonds">
<h3>Analysis of hydrogen bonds<a class="headerlink" href="#analysis-of-hydrogen-bonds" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">NAMDAnalyzer</span> <span class="kn">as</span> <span class="nn">nda</span>
<span class="kn">from</span> <span class="nn">NAMDAnalyzer.dataAnalysis.HydrogenBonds</span> <span class="kn">import</span> <span class="n">HydrogenBonds</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">nda</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;psfFile.psf&#39;</span><span class="p">,</span> <span class="s1">&#39;dcdFile.dcd&#39;</span><span class="p">)</span>

<span class="c1">#_To analyze hydrogen bonds auto-correlation</span>
<span class="c1">#_The &#39;hydrogens&#39; argument is optional, if None, they are obtained from hydrogens bound to donors</span>
<span class="c1">#_maxTime is tha maximum number of frame, maxR is the maximum distance for acceptor, hydrogen distance</span>
<span class="c1">#_step is the frame increment from origin to maxTime, minAngle is the minimum angle to accept hydrogen bond</span>
<span class="c1">#_between acceptor-hydrogen and donor-hydrogen vectors</span>

<span class="n">hb</span> <span class="o">=</span> <span class="n">HydrogenBonds</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">donors</span><span class="o">=</span><span class="s1">&#39;name OH2&#39;</span><span class="p">,</span> <span class="n">acceptors</span><span class="o">=</span><span class="s1">&#39;name OH2&#39;</span><span class="p">,</span> <span class="n">hydrogens</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">maxTime</span><span class="o">=</span><span class="mi">50</span>
                    <span class="n">nbrTimeOri</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxR</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">minAngle</span><span class="o">=</span><span class="mi">130</span><span class="p">)</span>

<span class="c1">#_For continuous auto-correlation (default if &#39;continuous&#39; not given)</span>
<span class="n">hb</span><span class="o">.</span><span class="n">compAutoCorrel</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#_For intermittent auto-correlation</span>
<span class="n">hb</span><span class="o">.</span><span class="n">compAutoCorrel</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#_To plot the result</span>
<span class="n">hb</span><span class="o">.</span><span class="n">plotAutoCorrel</span><span class="p">(</span><span class="n">corrType</span><span class="o">=</span><span class="s1">&#39;continuous&#39;</span><span class="p">)</span>
<span class="n">hb</span><span class="o">.</span><span class="n">plotAutoCorrel</span><span class="p">(</span><span class="s1">&#39;intermittent&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id3">
<h4>Outputs of previous code:<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<a class="reference internal image-reference" href="_images/hbContinuous.png"><img alt="_images/hbContinuous.png" src="_images/hbContinuous.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/hbIntermittent.png"><img alt="_images/hbIntermittent.png" src="_images/hbIntermittent.png" style="width: 24%;" /></a>
</div>
</div>
<div class="section" id="mean-squared-displacement-and-neutron-backscattering">
<h3>Mean-squared displacement and neutron backscattering<a class="headerlink" href="#mean-squared-displacement-and-neutron-backscattering" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">NAMDAnalyzer</span> <span class="kn">as</span> <span class="nn">nda</span>
<span class="kn">from</span> <span class="nn">NAMDAnalyzer.dataAnalysis.backscatteringDataConvert</span> <span class="kn">import</span> <span class="n">BackScatData</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">nda</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;psfFile.psf&#39;</span><span class="p">,</span> <span class="s1">&#39;dcdFile.dcd&#39;</span><span class="p">)</span>


<span class="c1">#_Defines some q-values for incoherent scattering function</span>
<span class="n">qVals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">]</span>

<span class="n">bs</span> <span class="o">=</span> <span class="n">BackScatData</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>


<span class="c1">#_To compute MSD for non exchangeable hydrogens in protein for increasing time steps,</span>
<span class="c1">#_without center of mass motion</span>
<span class="n">msd</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">bs</span><span class="o">.</span><span class="n">compMSD</span><span class="p">(</span><span class="n">frameNbr</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;protNonExchH&#39;</span><span class="p">,</span> <span class="n">alignCOM</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">msd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">bs</span><span class="o">.</span><span class="n">MSD</span> <span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">timestep</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">dcdFreq</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span>
<span class="n">msd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">msd</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">msd</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ns]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MSD [$\AA^{2}$]&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#_To compute and plot incoherent intermediate function, EISF and inoherent scattering</span>
<span class="c1">#_function for water hydrogens with 200 time steps</span>

<span class="n">bs</span><span class="o">.</span><span class="n">compScatteringFunc</span><span class="p">(</span><span class="n">qVals</span><span class="p">,</span> <span class="n">nbrTimeOri</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;waterH&#39;</span><span class="p">,</span> <span class="n">alignCOM</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nbrTS</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="n">bs</span><span class="o">.</span><span class="n">plotIntermediateFunc</span><span class="p">()</span>
<span class="n">bs</span><span class="o">.</span><span class="n">plotEISF</span><span class="p">()</span>
<span class="n">bs</span><span class="o">.</span><span class="n">plotScatteringFunc</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="id4">
<h4>Outputs of previous code:<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<a class="reference internal image-reference" href="_images/msd.png"><img alt="_images/msd.png" src="_images/msd.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/bs_interFunc.png"><img alt="_images/bs_interFunc.png" src="_images/bs_interFunc.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/bs_EISF.png"><img alt="_images/bs_EISF.png" src="_images/bs_EISF.png" style="width: 24%;" /></a>
<a class="reference internal image-reference" href="_images/bs_scatFunc.png"><img alt="_images/bs_scatFunc.png" src="_images/bs_scatFunc.png" style="width: 24%;" /></a>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Dataset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dataAnalysis/index.html">dataAnalysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dataAnalysis/BackscatteringDataConvert.html">BackscatteringDataConvert module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataAnalysis/HydrogenBonds.html">HydrogenBonds module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataAnalysis/ResidenceTime.html">ResidenceTime module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataAnalysis/Rotations.html">Rotations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataAnalysis/ScatDiffusion.html">ScatDiffusion module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dataManipulation/index.html">dataManipulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dataManipulation/molFit_quaternions.html">molFit_quaternions module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dataParsers/index.html">dataParsers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/dcdParser.html">dcdParser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/dcdReader.html">dcdReader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/HydroproReader.html">HydroproReader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/logParser.html">logParser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/logReader.html">logReader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/pdbParser.html">pdbParser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/pdbReader.html">pdbReader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/psfParser.html">psfParser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/psfReader.html">psfReader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/selParser.html">selParser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/velParser.html">velParser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataParsers/velReader.html">velReader module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="helpersFunctions/index.html">Helpers functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="helpersFunctions/ConstantsAndModels.html">Constant and models definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="helpersFunctions/DistanceChordDiagram.html">DistanceChordDiagram module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kdTree/index.html">KDTree</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kdTree/getWithin_kdTree.html">getWithin_kdTree module</a></li>
<li class="toctree-l3"><a class="reference internal" href="kdTree/periodic_kdtree.html">periodic_kdtree module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">NAMDAnalyzer’s documentation</a></li>
<li><a class="reference internal" href="#namdanalyzer">NAMDAnalyzer</a><ul>
<li><a class="reference internal" href="#installation">Installation:</a><ul>
<li><a class="reference internal" href="#unix-and-windows">Unix and Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#start-the-interpreter">Start the interpreter:</a></li>
<li><a class="reference internal" href="#usage">Usage:</a><ul>
<li><a class="reference internal" href="#open-log-file-and-plot-data">Open log file and plot data</a><ul>
<li><a class="reference internal" href="#outputs-of-previous-code">Outputs of previous code:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-trajectories-selection-and-analysis">Load trajectories, selection, and analysis</a><ul>
<li><a class="reference internal" href="#id1">Outputs of previous code:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#analysis-of-rotations">Analysis of rotations</a><ul>
<li><a class="reference internal" href="#id2">Outputs of previous code:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#analysis-of-hydrogen-bonds">Analysis of hydrogen bonds</a><ul>
<li><a class="reference internal" href="#id3">Outputs of previous code:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mean-squared-displacement-and-neutron-backscattering">Mean-squared displacement and neutron backscattering</a><ul>
<li><a class="reference internal" href="#id4">Outputs of previous code:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="modules.html"
                        title="next chapter">Dataset</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Dataset"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">NAMDAnalyzer 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Kevin Pounot.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>